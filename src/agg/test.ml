
open Parse

let test_parse s =
  let ll = logline_of_string s in
  let stream = logline_to_stream ll in
    print_endline "worked";;

let _ =
  let tests = [
      "12292|12292|1|evald|write_begin(2,19)";
      "12292|12292|1145856488.349801|evald|write_begin(2,19)";
      "12292|12292|1145856488.350200|evald|19=write(2,19)";
      "12292|12292|1145856488.351563|evald|close(5)";
      "12292|12292|1145856488.352746|evald|accept_begin(4)";
      "12293|12293|1145856488.346037|pool|0=connect(5) [127.0.0.1:6666,127.0.0.1:45676]";
      "12293|12293|1145856488.353959|pool|write_begin(2,39)";
      "12293|12293|1145856488.354360|pool|39=write(2,39)";
      "12293|12293|1145856488.355594|pool|6=socket(2,1,6)";
      "12293|12293|1145856488.356331|pool|connect_begin(6)";
      "12293|12293|1145856488.356330|pool|0=connect(6) [127.0.0.1:6666,127.0.0.1:45677]";
      "12293|12293|1145856488.357175|pool|write_begin(2,39)";
      "12293|12293|1145856488.357545|pool|39=write(2,39)";
      "12293|12293|1145856488.358739|pool|7=socket(2,1,6)";
      "12293|12293|1145856488.359480|pool|connect_begin(7)";
      "12293|12293|1145856488.359479|pool|0=connect(7) [127.0.0.1:6666,127.0.0.1:45678]";
      "12293|12293|1145856488.360331|pool|write_begin(2,39)";
      "12293|12293|1145856488.360739|pool|39=write(2,39)";
      "12293|12293|1145856488.361924|pool|8=socket(2,1,6)";
    ] in
    List.iter (fun s -> test_parse s) tests;;
